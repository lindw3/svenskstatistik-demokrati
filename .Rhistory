legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white"),
legend.text = element_text(color = "black" , family = "sans") ,
legend.title = element_text(color = "black" , family = "sans") ,
text = element_text(size=12, face="plain", color = "white" , family = "sans"),
axis.title = element_text(color = "white" , family = "sans"),
axis.text = element_text(color = "white" , family = "sans"))
# Partifärger
partifärger <- scale_colour_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Övriga partier" = "grey"))
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
partifärger -> p_valresultat_sverige
ggplotly(p_valresultat_sverige , tooltip = "text") %>% config(displayModeBar = F)
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
partifärger -> p_valresultat_sverige
ggplotly(p_valresultat_sverige , tooltip = "text") %>% config(displayModeBar = F)
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position = c(0.85, 0.5)) +
partifärger -> p_valresultat_sverige
ggplotly(p_valresultat_sverige , tooltip = "text") %>% config(displayModeBar = F)
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position.inside = c(0.85 , 0.5)) +
partifärger -> p_valresultat_sverige
ggplotly(p_valresultat_sverige , tooltip = "text") %>% config(displayModeBar = F)
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position = "inside") +
partifärger
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position = "bottom") +
partifärger
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position = "right") +
partifärger
df <- valresultat_sverige %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
theme(legend.position = "right") +
partifärger -> p_valresultat_sverige
ggplotly(p_valresultat_sverige , tooltip = "text") %>% config(displayModeBar = F)
ggplotly(p_valresultat_sverige, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
library(readxl)
valresultat_eu <- read_excel("data/valresultat_eu.xlsx",
col_types = c("text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
View(valresultat_eu)
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 50, 5), limits = c(0, 50)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
partifärger <- scale_colour_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Junilistan" = "#ff8c00" ,
"Övriga partier" = "grey"))
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
valresultat_eu <- read_excel("data/valresultat_eu.xlsx",
col_types = c("text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
valresultat_eu <- read_excel("data/valresultat_eu.xlsx",
col_types = c("text", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric"))
df <- valresultat_eu %>%
pivot_longer(!År, names_to = "Parti", values_to = "Röster")
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_trace(
x = c(min(df$År), max(df$År)),
y = c(0.04, 0.04),
type = "scatter",
mode = "lines",
line = list(dash = "dot", color = "black"),
showlegend = FALSE
)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_trace(
x = c(min(df$År), max(df$År)),
y = c(0.04, 0.04),
type = "scatter",
mode = "lines",
line = list(dash = "dot", color = "black"),
showlegend = FALSE
)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_trace(
x = c(min(df$År), max(df$År)),
y = c(0.04, 0.04),
mode = "lines",
line = list(dash = "dot", color = "black"),
showlegend = FALSE
)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_trace(
x = c(min(df$År), max(df$År)),
y = c(0.04, 0.04),
mode = "lines",
line = list(dash = "dot"),
showlegend = FALSE
)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_segments(x = 1990, xend = 2025, y = 0.04, yend = 0.04)
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger
df %>%
ggplot(aes(x = År, y = Röster, group = Parti, colour = Parti,
text = paste("År: ", År, "\n", Parti, "\nRöster: ", Röster, "%"))) +
geom_line(linewidth = 1) +
scale_y_continuous(labels = percent_format(scale = 1), breaks = seq(0, 30, 5), limits = c(0, 30)) +
ss_theme +
partifärger -> p_valresultat_eu
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_segments(x = 1990, xend = 2025, y = 0.04, yend = 0.04)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle")) %>%
add_lines(x = 1990, xend = 2025, y = 0.04, yend = 0.04)
ggplotly(p_valresultat_eu, tooltip = "text") %>%
config(displayModeBar = F) %>%
layout(legend = list(x = 1.05, y = 0.5, xanchor = "left", yanchor = "middle"))
library(readxl)
partysympati_kön_ålder <- read_excel("data/partysympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
View(partysympati_kön_ålder)
library(flexdashboard)
library(ggplot2)
library(stringr)
library(scales)
library(dplyr)
library(tidyr)
library(DT)
library(png)
library(data.table)
library(magrittr)
library(gridExtra)
library(openxlsx)
library(patchwork)
library(ggthemes)
library(plotly)
library(ggridges)
library(forecast)
library(GGally)
library(cluster)
library(sf)
library(ggrepel)
library(ggtext)
partysympati_kön_ålder <- read_excel("data/partysympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
View(df)
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
partysympati_kön_ålder <- read_excel("data/partysympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
partysympati_kön_ålder <- read_excel("data/partysympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
colnames(partysympati_kön_ålder) <- c("År" , "Kön" , "Ålder" , "Moderaterna" , "Centerpartiet" , "Liberalerna" ,
"Kristdemokraterna" , "Miljöpartiet" , "Socialdemokraterna" , "Vänsterpartiet" ,
"Sverigedemokraterna" , "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
partifärger_fill <- scale_fill_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Junilistan" = "#ff8c00" ,
"Övriga partier" = "grey"))
partifärger_colour <- scale_colour_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Junilistan" = "#ff8c00" ,
"Övriga partier" = "grey"))
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(x = Parti , y = Andel)) +
geom_col(fill = Kön , position = "dodge") +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti , y = Andel)) +
geom_col(aes(fill = Kön , position = "dodge")) +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#009933",
"Män" = "#ff8c00"))
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#009933",
"Män" = "#ff8c00"))
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
?reorder
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(y = reorder(Parti, decreasing = TRUE) , x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
wlibrary(forcats)
library(forcats)
df %>%
ggplot(aes(y = fct_reorder(Parti, Parti, .fun = desc), x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df %>% partisympatier_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partisympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt",
Parti != "Övriga partier") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd"))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt",
Parti != `Övriga partier`) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd"))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön , Färg) %>%
summarize(Andel = sum(Andel))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
summarize(Andel = sum(Andel) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
reframe(Andel = sum(Andel) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
reframe(Andel = sum(Andel , na.rm = TRUE) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
