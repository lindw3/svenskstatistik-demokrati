library(png)
library(data.table)
library(magrittr)
library(gridExtra)
library(openxlsx)
library(forcats)
library(patchwork)
library(ggthemes)
library(plotly)
library(ggridges)
library(forecast)
library(GGally)
library(cluster)
library(sf)
library(ggrepel)
library(ggtext)
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df2_blå <- df2 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df2_röd <- df2 %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
df2_combined <- cbind(df2_blå, df2_röd)
df2_combined <- df2_combined %>%
select(-c(5, 6, 7))
colnames(df2_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df2_combined <- df2_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df2_combined$År <- as.factor(df2_combined$År)
View(df2_combined)
df2_combined <- cbind(df2_blå, df2_röd)
df2_combined <- df2_combined %>%
select(-c(5, 6, 7))
colnames(df2_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df2_combined$Kön_Ålder <- paste(df2_combined$Kön, df2_combined$Ålder, sep = ", ")
df2_combined$Blocktillhörighet <- df2_combined$Blå / (df2_combined$Blå + df2_combined$Röd)
df2_combined$Blocktillhörighet <- round(df2_combined$Blocktillhörighet, 2)
ggplot(df, aes(x = År, y = Blocktillhörighet, color = Kön_Ålder, group = Kön_Ålder)) +
geom_line() +
labs(title = "Blocktillhörighet Over Years",
x = "År",
y = "Blocktillhörighet",
color = "Kön, Ålder") +
theme_minimal()
ggplot(df2_combined, aes(x = År, y = Blocktillhörighet, color = Kön_Ålder, group = Kön_Ålder)) +
geom_line() +
labs(title = "Blocktillhörighet Over Years",
x = "År",
y = "Blocktillhörighet",
color = "Kön, Ålder") +
theme_minimal()
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
df2_combined %>%
ggplot(aes(x = Blocktillhörighet , y = År , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 0.75) +
ss_theme
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 0.5 , alpha = 0.75) +
ss_theme
df1 <- partisympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df1_blå <- df1 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df1_röd <- df1 %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
df1_combined <- cbind(df1_blå, df1_röd)
df1_combined <- df1_combined %>%
select(-c(5, 6, 7))
colnames(df1_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df1_combined <- df1_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df1_combined$År <- as.factor(df1_combined$År)
View(df1_combined)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 0.5 , alpha = 0.75) +
geom_line(data = df1_combined , linewidth = 1)
ggplot(NULL, aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(data = df2_combined , linewidth = 0.5 , alpha = 0.75) +
ss_theme
ggplot(NULL, aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(data = df2_combined , linewidth = 0.5 , alpha = 0.75) +
geom_line(data = df1_combined , linewidth = 1) +
ss_theme
ggplot(NULL, aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(data = df2_combined , linewidth = 0.5 , alpha = 0.75) +
geom_line(data = df1_combined , linewidth = 1) +
scale_x_discrete(labels = c("2006", "2024")) +
ss_theme
ggplot(NULL, aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(data = df2_combined , linewidth = 0.5 , alpha = 0.75) +
geom_line(data = df1_combined , linewidth = 1) +
scale_x_discrete() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.5, 0.5)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , linewidth = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , linewidth = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1, 0.5)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , linewidth = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1, 0.75)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , linewidth = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.2, 0.8)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , linewidth = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.5, 0.75)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df2_combined$highlight <- ifelse(df2_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.5, 0.5)
df2_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df_blå <- df %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df_röd <- df %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
df_combined <- cbind(df_blå, df_röd)
df_combined <- df2_combined %>%
select(-c(5, 6, 7))
colnames(df_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df_combined$År <- as.factor(df_combined$År)
df_combined$highlight <- ifelse(df_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.5, 0.5)
df_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df_blå <- df %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df_röd <- df %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
df_combined <- cbind(df_blå, df_röd)
df_combined <- df_combined %>%
select(-c(5, 6, 7))
colnames(df_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df_combined$År <- as.factor(df_combined$År)
df_combined$highlight <- ifelse(df_combined$Kön_Ålder %in% c("Kvinnor, Totalt", "Män, Totalt"), 1.5, 0.5)
df_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
ss_theme
df_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 )
ss_theme
df_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined
View(df_combined)
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) +
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017" %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017" %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017") %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ff6262",
"Kvinnor, 30-49" = "#ff3b3b",
"Kvinnor, 50-64" = "#ff0000",
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#64b6ee",
"Män, 30-49" = "#427bd2",
"Män, 50-64" = "#2c43b0",
"Män, Totalt" = "#1e2791"))
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ff6262",
"Kvinnor, 30-49" = "#ff3b3b",
"Kvinnor, 50-64" = "#ff0000",
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#64b6ee",
"Män, 30-49" = "#427bd2",
"Män, 50-64" = "#2c43b0",
"Män, Totalt" = "#1e2791")) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5 ) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5,
labels = percent_format(scale = 1)) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75),
labels = percent_format(scale = 1)) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
?percent_format
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75) , breaks = 0.5,
label_percent(scale = 100)) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
df_combined
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75),
breaks = seq(0.25, 0.75, by = 0.05),
labels = scales::percent_format(accuracy = 1)) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
df_combined %>%
filter(!År %in% c("2006", "2007", "2008",   # Då Centerpartiet var ett högerparti fram till 2018
"2009", "2010", "2011" ,
"2012" , "2013" , "2014" ,
"2015" , "2016" ,"2017")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder , size = highlight)) +
geom_line() +
scale_size_identity() +
scale_y_continuous(limits = c(0.25, 0.75),
breaks = 0.5,
labels = scales::percent_format(accuracy = 1)) +
scale_color_manual(values = c("Kvinnor, 18-29" = "#ffb1b1",
"Kvinnor, 30-49" = "#ff6262",
"Kvinnor, 50-64" = "#ff3b3b",
"Kvinnor, 65+" = "#ff0000" ,
"Kvinnor, Totalt" = "#b30000",
"Män, 18-29" = "#b0e0e6",
"Män, 30-49" = "#64b6ee",
"Män, 50-64" = "#427bd2",
"Män, 65+" = "#2c43b0" ,
"Män, Totalt" = "#1e2791")) +
labs(color = "Kategori") +
ss_theme
df <- partisympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön,
text = paste(Parti, "\nKön: ", Kön, "\nAndel: ", Andel, "%"))) +
geom_col(position = "dodge") +
ss_theme +
scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df <- partisympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön,
text = paste(Parti, "\nKön: ", Kön, "\nAndel: ", Andel, "%"))) +
geom_col(position = "dodge") +
ss_theme +
scale_x_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df <- partisympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön,
text = paste(Parti, "\nKön: ", Kön, "\nAndel: ", Andel, "%"))) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
