"Kristdemokraterna" , "Miljöpartiet" , "Socialdemokraterna" , "Vänsterpartiet" ,
"Sverigedemokraterna" , "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
partifärger_fill <- scale_fill_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Junilistan" = "#ff8c00" ,
"Övriga partier" = "grey"))
partifärger_colour <- scale_colour_manual(values = c("Centerpartiet" = "#009933" ,
"Feministiskt initiativ" = "#CD1B68" ,
"Kristdemokraterna" = "#000077" ,
"Liberalerna" = "#006AB3" ,
"Miljöpartiet" = "#83CF39" ,
"Moderaterna" = "#52BDEC" ,
"Piratpartiet" = "#572B85" ,
"Socialdemokraterna" = "#E8112d" ,
"Sverigedemokraterna" = "#DDDD00" ,
"Vänsterpartiet" = "#DA291C" ,
"Junilistan" = "#ff8c00" ,
"Övriga partier" = "grey"))
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(x = Parti , y = Andel)) +
geom_col(fill = Kön , position = "dodge") +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti , y = Andel)) +
geom_col(aes(fill = Kön , position = "dodge")) +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
partifärger_fill
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#009933",
"Män" = "#ff8c00"))
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(x = Parti, y = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#009933",
"Män" = "#ff8c00"))
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
?reorder
df <- partysympati_kön_ålder %>%
filter(Ålder == "Totalt" ,
År == 2024 ,
Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df %>%
ggplot(aes(y = reorder(Parti, decreasing = TRUE) , x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
wlibrary(forcats)
library(forcats)
df %>%
ggplot(aes(y = fct_reorder(Parti, Parti, .fun = desc), x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df %>%
ggplot(aes(y = Parti, x = Andel, fill = Kön)) +
geom_col(position = "dodge") +
ss_theme +
scale_fill_manual(values = c("Kvinnor" = "#DDDD00",
"Män" = "#ff8c00"))
df %>% partisympatier_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partisympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder = "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt",
Parti != "Övriga partier") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd"))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt",
Parti != `Övriga partier`) %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd"))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön , Färg) %>%
summarize(Andel = sum(Andel))
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
summarize(Andel = sum(Andel) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
reframe(Andel = sum(Andel) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(År, Kön) %>%
reframe(Andel = sum(Andel , na.rm = TRUE) ,
Färg = Färg)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
library(flexdashboard)
library(ggplot2)
library(stringr)
library(scales)
library(dplyr)
library(tidyr)
library(DT)
library(png)
library(data.table)
library(magrittr)
library(gridExtra)
library(openxlsx)
library(forcats)
library(patchwork)
library(ggthemes)
library(plotly)
library(ggridges)
library(forecast)
library(GGally)
library(cluster)
library(sf)
library(ggrepel)
library(ggtext)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier")
View(df)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg) %>%
summarize(Andel = Andel,
År = År ,
Kön = Kön)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg) %>%
reframe(Andel = Andel,
År = År ,
Kön = Kön)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön) %>%
reframe(Andel = Andel)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön) %>%
reframe(Andel = Andel , na.rm = TRUE)
df <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
df2 <- partysympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
df2 <- partysympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti)
df2
df2 <- partysympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti ,
Ålder = Ålder) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
d2
View(df2)
df1 <- partysympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
View(df)
View(df1)
df2 <- partysympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti ,
Ålder = Ålder) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE)) %>%
mutate(Politisk_lutning = sum(Röd / (Röd + Blå)))
partisympati_kön_ålder <- read_excel("data/partisympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
library(readxl)
partisympati_kön_ålder <- read_excel("data/partisympati_kön_ålder.xlsx",
col_types = c("numeric", "text", "text",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric"))
colnames(partisympati_kön_ålder) <- c("År" , "Kön" , "Ålder" , "Moderaterna" , "Centerpartiet" , "Liberalerna" ,
"Kristdemokraterna" , "Miljöpartiet" , "Socialdemokraterna" , "Vänsterpartiet" ,
"Sverigedemokraterna" , "Övriga partier")
df1 <- partisympati_kön_ålder %>%
filter(Kön != "Båda",
Ålder == "Totalt") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti ,
Ålder = Ålder) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE)) %>%
mutate(Politisk_lutning = sum(Röd / (Röd + Blå)))
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti ,
Ålder = Ålder) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE))
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel") %>%
group_by(År, Kön) %>%
reframe(Andel = Andel ,
Parti = Parti ,
Ålder = Ålder) %>%
mutate(Färg = ifelse(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna"), "Blå", "Röd")) %>%
filter(Parti != "Övriga partier") %>%
group_by(Färg, År, Kön , Ålder) %>%
reframe(Andel = sum(Andel , na.rm = TRUE)) %>%
group_by(År, Kön , Ålder) %>%
filter(Andel != min(Andel)) %>%
ungroup()
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df2_blå <- df %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Andel = sum(Andel, na.rm = TRUE)) %>%
pull(Andel)
df2_blå <- df2 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Andel = sum(Andel, na.rm = TRUE)) %>%
pull(Andel)
df2_blå
df2_blå <- df2 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Andel = sum(Andel, na.rm = TRUE))
View(df2)
View(df2_blå)
df2_blå <- df2 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df2_röd <- df2 %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
View(df2_röd)
df_combined <- rbind(df2_blå, df2_röd)
df_combined
df_combined <- cbind(df2_blå, df2_röd)
df_combined
View(df_combined)
df_combined <- df_combined %>%
select(-c(5, 6, 7))
colnames(df_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df_combined <- df_combined %>%
mutate(Blocktillhörighet = sum(Blå / (Blå + Röd)))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = Blå / (Blå + Röd))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 1))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ","))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = " , "))
df_combined <- df_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df_combined %>%
ggplot(aes(x = Blocktillhörighet , y = År , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
df_combined$År <- as.factor(df_combined$År)
df_combined %>%
ggplot(aes(x = Blocktillhörighet , y = År , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
df_combined %>%
ggplot(aes(x = År , y = År , Blocktillhörighet = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
df_combined %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
partisympati_kön_ålder
View(partisympati_kön_ålder)
partisympati_kön_ålder %>%
group_by(År) %>%
reframe(Totalt = sum(Moderaterna, Liberalerna, Kristdemokraterna, Sverigedemokraterna))
df <- partisympati_kön_ålder %>%
group_by(År) %>%
reframe(Totalt = (Moderaterna + Liberalerna + Kristdemokraterna + Sverigedemokraterna))
View(df)
df <- partisympati_kön_ålder %>%
group_by(År) %>%
reframe(Totalt = (Moderaterna + Liberalerna + Kristdemokraterna + Sverigedemokraterna , na.rm = TRUE))
df2 <- partisympati_kön_ålder %>%
filter(Kön != "Båda") %>%
pivot_longer(!c(År, Kön, Ålder) , names_to = "Parti" , values_to = "Andel")
df2_blå <- df2 %>%
filter(Parti %in% c("Moderaterna", "Liberalerna", "Kristdemokraterna", "Sverigedemokraterna")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Blå = sum(Andel, na.rm = TRUE))
df2_röd <- df2 %>%
filter(Parti %in% c("Miljöpartiet", "Socialdemokraterna",
"Vänsterpartiet", "Centerpartiet")) %>%
group_by(År, Kön , Ålder) %>%
summarise(Röd = sum(Andel, na.rm = TRUE))
df2_combined <- cbind(df2_blå, df2_röd)
df2_combined <- df2_combined %>%
select(-c(5, 6, 7))
colnames(df2_combined) <- c("År" , "Kön" , "Ålder" , "Blå" , "Röd")
df2_combined <- df2_combined %>%
mutate(Blocktillhörighet = round(Blå / (Blå + Röd) , 2) ,
Kön_Ålder = paste(Kön, Ålder, sep = ", "))
df2_combined$År <- as.factor(df2_combined$År)
df2_combinde
df2_combined
df2_combined %>%
filter(År != c("2006" , "2007" , "2008" , "2009" , "2010")) %>%
ggplot(aes(x = År , y = Blocktillhörighet , group = Kön_Ålder , color = Kön_Ålder)) +
geom_line(linewidth = 1) +
ss_theme
